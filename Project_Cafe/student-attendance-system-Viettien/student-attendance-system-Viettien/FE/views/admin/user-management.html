<div class="page-container user-mgmt" ng-controller="UserManagementController">

  <!-- ===== üß≠ KH·ªêI 1: HEADER ===== -->
  <section class="section header-section">
    <div class="header-left">
      <h2><i class="fa fa-users-cog"></i> Qu·∫£n l√Ω ng∆∞·ªùi d√πng</h2>
      <p>Th√™m, s·ª≠a, kh√≥a/m·ªü t√†i kho·∫£n v√† xu·∫•t/nh·∫≠p d·ªØ li·ªáu</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" ng-click="openAddUser()"><i class="fa fa-plus"></i> Th√™m m·ªõi</button>
      <button class="btn btn-success" ng-click="importExcel()"><i class="fa fa-file-import"></i> Import</button>
      <button class="btn btn-warning" ng-click="exportExcel()"><i class="fa fa-file-export"></i> Export</button>
    </div>
  </section>

  <!-- ===== üîç KH·ªêI 2: B·ªò L·ªåC & T√åM KI·∫æM ===== -->
  <section class="section filter-section">
    <h3><i class="fa fa-filter"></i> B·ªô l·ªçc & t√¨m ki·∫øm</h3>
    <div class="filter-bar">
      <input type="text" placeholder="üîç T√¨m theo t√™n ho·∫∑c t√†i kho·∫£n..." ng-model="search" ng-change="loadUsers()">
      <select ng-model="filterRole" ng-change="loadUsers()">
        <option value="">-- T·∫•t c·∫£ vai tr√≤ --</option>
        <option value="Admin">Admin</option>
        <option value="Lecturer">Gi·∫£ng vi√™n</option>
        <option value="Advisor">C·ªë v·∫•n</option>
        <option value="Student">Sinh vi√™n</option>
      </select>
    </div>
  </section>

  <!-- ===== üìã KH·ªêI 3: DANH S√ÅCH NG∆Ø·ªúI D√ôNG ===== -->
  <section class="section table-section">
    <h3><i class="fa fa-table"></i> Danh s√°ch ng∆∞·ªùi d√πng</h3>
    <div class="table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th>#</th>
            <th>·∫¢nh</th>
            <th>H·ªç t√™n</th>
            <th>T√™n ƒëƒÉng nh·∫≠p</th>
            <th>Email</th>
            <th>Vai tr√≤</th>
            <th>Tr·∫°ng th√°i</th>
            <th class="center">Thao t√°c</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="u in users">
            <td>{{$index + 1}}</td>
            <td><img ng-src="{{u.avatarUrl || 'assets/img/default-avatar.png'}}" class="avatar"></td>
            <td>{{u.fullName}}</td>
            <td>{{u.username}}</td>
            <td>{{u.email}}</td>
            <td>{{u.role}}</td>
            <td>
              <span ng-class="{'status-active': u.isActive, 'status-inactive': !u.isActive}">
                {{u.isActive ? 'Ho·∫°t ƒë·ªông' : 'ƒê√£ kh√≥a'}}
              </span>
            </td>
            <td class="center">
              <button class="btn btn-small btn-edit" ng-click="editUser(u)"><i class="fa fa-edit"></i></button>
              <button class="btn btn-small btn-lock" ng-click="toggleUser(u)">
                <i class="fa" ng-class="u.isActive ? 'fa-lock' : 'fa-unlock'"></i>
              </button>
              <button class="btn btn-small btn-danger" ng-click="deleteUser(u)"><i class="fa fa-trash"></i></button>
            </td>
          </tr>
          <tr ng-if="!users || users.length === 0">
            <td colspan="8" class="no-data">Kh√¥ng c√≥ d·ªØ li·ªáu</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- ===== üìÑ KH·ªêI 4: PH√ÇN TRANG ===== -->
  <section class="section pagination-section">
    <div class="pagination">
      <button ng-disabled="page <= 1" ng-click="changePage(page - 1)">¬´</button>
      <span>Trang {{page}} / {{totalPages}}</span>
      <button ng-disabled="page >= totalPages" ng-click="changePage(page + 1)">¬ª</button>
    </div>
  </section>

</div>
